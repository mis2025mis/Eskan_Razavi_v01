<!doctype html>
<html lang="fa" dir="rtl">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>اسکان زوار حرم رضوی</title>
    <!-- Persian font: Vazirmatn -->
    <link href="https://fonts.googleapis.com/css2?family=Vazirmatn:wght@400;700&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @font-face {
            font-family: 'IranNastaliq';
            src: url('./fonts/IranNastaliq.woff') format('woff'),
            url('./fonts/IranNastaliq.ttf') format('truetype');
            font-weight: normal;
            font-style: normal;
            font-display: swap;
        }

        @font-face {
      font-family: 'BJadidBold';
      src: url('./fonts/BJadidBold.ttf') format('truetype');
      font-weight: bold;
      font-style: normal;
      font-display: swap;
    }

        @font-face {
      font-family: 'Entezar';
      src: url('./fonts/Entezar.ttf') format('truetype');
      font-weight: normal;
      font-style: normal;
      font-display: swap;
    }

        .irannastaliq {
            font-family: 'IranNastaliq', serif !important;
        }

        .bjadidbold {
      font-family: 'BJadidBold', serif !important;
      font-weight: bold;
    }

    .entezar {
      font-family: 'Entezar', serif !important;
    }


        body, button, input, textarea, select {
            font-family: 'Vazirmatn', 'Tahoma', 'Arial', sans-serif !important;
            letter-spacing: 0.01em;
        }

        h1, h2, h3, h4, h5, h6 {
            font-weight: 700;
        }
    </style>
</head>

<body dir="rtl"
      class="bg-gray-100 bg-no-repeat bg-cover bg-center min-h-screen"
      style="background-image: url('./images/Haram-3.jpg');">
<!-- Toast Container -->
<div id="toast"
     class="fixed top-5 right-5 z-50 hidden items-center max-w-xs p-4 text-sm text-white bg-green-500 rounded-lg shadow-lg"
     role="alert">
    <span id="toast-message">عملیات با موفقیت انجام شد.</span>
    <button type="button"
            class="ml-auto -mx-1.5 -my-1.5 text-white hover:text-gray-200 focus:outline-none focus:ring-2 focus:ring-white p-1 rounded-md"
            onclick="hideToast()">
        <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
            <path fill-rule="evenodd"
                  d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 011.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z"
                  clip-rule="evenodd"></path>
        </svg>
    </button>
</div>

<!-- Navigation -->
<nav dir="ltr" class="flex justify-around items-center shadow-md py-[10px] bg-green-200">
    <div class="gap-x-2 flex">
        <button class="exit-button flex items-center px-3 py-2 rounded-md text-sm font-medium transition-colors text-white bg-green-600 hover:bg-green-700">
            <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4 ml-2" fill="none" viewBox="0 0 24 24"
                 stroke="currentColor">
                <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
                <polyline points="16 17 21 12 16 7"></polyline>
                <line x1="21" y1="12" x2="9" y2="12"></line>
            </svg>
            دعوت به خروج
        </button>

        <button class="set-exit-button flex items-center px-3 py-2 rounded-md text-sm font-medium transition-colors text-white bg-green-600 hover:bg-green-700">
            <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4 ml-2" fill="none" viewBox="0 0 24 24"
                 stroke="currentColor">
                <path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"></path>
                <circle cx="9" cy="7" r="4"></circle>
                <line x1="22" y1="11" x2="16" y2="11"></line>
            </svg>
            ثبت خروج
        </button>

        <button class="signup-button flex items-center px-3 py-2 rounded-md text-sm font-medium transition-colors text-white bg-green-600 hover:bg-green-700">
            <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4 ml-2" fill="none" viewBox="0 0 24 24"
                 stroke="currentColor">
                <path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"></path>
                <circle cx="9" cy="7" r="4"></circle>
                <line x1="19" y1="8" x2="19" y2="14"></line>
                <line x1="22" y1="11" x2="16" y2="11"></line>
            </svg>
            ثبت نام و ورود
        </button>

        <button class="adminpanel-button flex items-center px-3 py-2 rounded-md text-sm font-medium transition-colors text-white bg-green-600 hover:bg-green-700">
            <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4 ml-2" fill="none" viewBox="0 0 24 24"
                 stroke="currentColor">
                <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                <line x1="3" y1="9" x2="21" y2="9"></line>
                <line x1="9" y1="21" x2="9" y2="9"></line>
            </svg>
            پنل ادمین
        </button>
    </div>

    <h1 class="fetch-data text-xl  font-bold text-gray-900 text-right flex items-center gap-2">

        <span class="entezar" style="font-size:32px;">اسکان زوار حرم رضوی</span>
        <img src="./logo/salam.png" alt="لوگو" class="h-20 w-20 object-contain mr-2"
             style="border-radius: 12px;"/>
    </h1>
</nav>


<!-- Exit Page -->
<div style="display: none;" class="exit-page max-w-6xl mx-auto p-6 mt-10">
    <div class="mb-6 p-4 rounded-lg border-r-4 bg-green-50 border-green-500">
        <div class="flex items-center justify-between">
            <div class="flex items-center">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                     stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                     class="lucide lucide-users w-6 h-6 text-green-600 ml-3">
                    <path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"></path>
                    <circle cx="9" cy="7" r="4"></circle>
                    <path d="M22 21v-2a4 4 0 0 0-3-3.87"></path>
                    <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
                </svg>
                <div>
                    <h3 class="font-semibold text-gray-900">وضعیت عادی</h3>
                    <p class="percent text-sm text-gray-600"></p>
                </div>
            </div>
            <div class="text-right">
                <p class="text-sm text-gray-600">حداکثر اقامت مجاز:</p>
                <p class="highest-settlement-time font-semibold"></p>
            </div>
        </div>
    </div>
    <div class="bg-white rounded-lg shadow-md p-6">
        <h2 class="text-2xl font-bold text-gray-900 mb-6 text-right flex items-center">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                 stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                 class="lucide lucide-clock w-6 h-6 ml-3">
                <circle cx="12" cy="12" r="10"></circle>
                <polyline points="12 6 12 12 16 14"></polyline>
            </svg>
            <span class="bjadidbold" style="font-size:22px;">پنل دعوت به خروج</span>

        </h2>
        <div class="invite-exit text-center py-12">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                 stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                 class="lucide lucide-users w-16 h-16 text-gray-400 mx-auto mb-4">
                <path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"></path>
                <circle cx="9" cy="7" r="4"></circle>
                <path d="M22 21v-2a4 4 0 0 0-3-3.87"></path>
                <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
            </svg>
            <h3 class="text-lg font-medium text-gray-600 mb-2">سیستم دعوت به خروج غیرفعال است</h3>
            <p class="text-gray-500">این پنل زمانی فعال می‌شود که ظرفیت اقامتگاه به 95% برسد.</p>
        </div>
    </div>
</div>

<!-- Set Exit Page -->
<div style="display: none;" class="set-exit-page max-w-4xl mx-auto p-6 mt-10">
    <div class="bg-white rounded-lg shadow-md p-6 mb-6">
        <h2 class="text-2xl font-bold text-gray-900 mb-6 text-right">
            <span class="bjadidbold" style="font-size:22px;">ثبت خروج زائر</span>
        </h2>
        <form class="form space-y-6">
            <div>
                <label for="uniqueId" class="block text-sm font-medium text-gray-700 text-right mb-2">شماره اختصاصی
                    زائر</label>
                <input type="number" id="uniqueId" pattern="\d{5,15}" placeholder="شماره اختصاصی 5 تا 15 رقمی وارد کنید"
                       required
                       class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-right">
            </div>
            <div class="flex justify-start">
                <button type="submit" onclick="setExit(event)"
                        class="flex items-center px-6 py-2 bg-red-600 hover:bg-red-700 text-white rounded-md font-medium transition-colors">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                         stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                         class="lucide lucide-user-minus w-4 h-4 ml-2">
                        <path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"></path>
                        <circle cx="9" cy="7" r="4"></circle>
                        <line x1="22" y1="11" x2="16" y2="11"></line>
                    </svg>
                    ثبت خروج
                </button>
            </div>
        </form>
    </div>

    <div class="bg-white rounded-lg shadow-md p-6">
        <h3 class="text-xl font-bold text-gray-900 mb-4 text-right">لیست زائران فعال</h3>
        <div class="overflow-x-auto">
            <table class="activeGuestsTable w-full text-sm text-right">
                <thead class="bg-gray-50">
                <tr>
                    <th class="px-4 py-3 text-right">نام کامل</th>
                    <th class="px-4 py-3 text-right">شماره اختصاصی</th>
                    <th class="px-4 py-3 text-right">زمان ورود</th>
                    <th class="px-4 py-3 text-right">مدت اقامت</th>
                </tr>
                </thead>
                <tbody class="body divide-y divide-gray-200"></tbody>
            </table>
        </div>
    </div>
</div>

<!-- Signup Page -->
<div style="display: none;" class="signup-page max-w-4xl mx-auto p-6 mt-10">
    <form class="form bg-white rounded-lg shadow-md p-6">
        <h2 class="text-2xl font-bold text-gray-900 mb-6 text-right">
           <span class="bjadidbold" style="font-size:22px;">ثبت نام و ورود زائر</span>
        </h2>
        <div class="space-y-6">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div>
                    <label for="firstName" class="block text-sm font-medium text-gray-700 text-right mb-2">نام</label>
                    <input type="text" id="firstName" name="firstName" required value=""
                           class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-right">
                </div>
                <div>
                    <label for="lastName" class="block text-sm font-medium text-gray-700 text-right mb-2">نام
                        خانوادگی</label>
                    <input type="text" id="lastName" name="lastName" required value=""
                           class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-right">
                </div>
            </div>
            <div>
                <label for="uniqueId" class="block text-sm font-medium text-gray-700 text-right mb-2">شماره اختصاصی (5
                    تا 15 رقمی)</label>
                <input type="number" id="uniqueId" name="uniqueId" pattern="\d{5,15}" required value=""
                       placeholder="مثال: 12345678"
                       class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-right">
            </div>
            <div class="flex justify-start">
                <button type="submit" onclick="setGuest(event)"
                        class="flex items-center px-6 py-2 rounded-md font-medium transition-colors bg-blue-600 hover:bg-blue-700 text-white">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                         stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                         class="lucide lucide-user-plus w-4 h-4 ml-2">
                        <path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"></path>
                        <circle cx="9" cy="7" r="4"></circle>
                        <line x1="19" y1="8" x2="19" y2="14"></line>
                        <line x1="22" y1="11" x2="16" y2="11"></line>
                    </svg>
                    ثبت ورود زائر
                </button>
            </div>
        </div>
    </form>
</div>

<!-- Admin Panel Page -->
<div class="adminpanel-page max-w-4xl mx-auto p-6 mt-10">
    <div class="bg-white rounded-lg shadow-md p-6">
        <h2 class="text-2xl font-bold text-gray-900 mb-6 text-right">
            <span class="bjadidbold" style="font-size:22px;">پنل تنظیمات ادمین</span>
        </h2>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
            <div class="bg-blue-50 p-4 rounded-lg">
                <div class="flex items-center justify-between">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                         stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                         class="lucide lucide-users w-8 h-8 text-blue-600">
                        <path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"></path>
                        <circle cx="9" cy="7" r="4"></circle>
                        <path d="M22 21v-2a4 4 0 0 0-3-3.87"></path>
                        <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
                    </svg>
                    <div class="text-right">
                        <h3 class="text-lg font-semibold text-gray-900">زائران فعال</h3>
                        <p class="active-guests text-2xl font-bold text-blue-600"></p>
                    </div>
                </div>
            </div>
            <div class="bg-green-50 p-4 rounded-lg">
                <div class="flex items-center justify-between">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                         stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                         class="lucide lucide-clock w-8 h-8 text-green-600">
                        <circle cx="12" cy="12" r="10"></circle>
                        <polyline points="12 6 12 12 16 14"></polyline>
                    </svg>
                    <div class="text-right">
                        <h3 class="text-lg font-semibold text-gray-900">حداکثر اقامت</h3>
                        <p class="admin-highest-settlement-time text-2xl font-bold text-green-600"></p>
                    </div>
                </div>
            </div>
        </div>
        <form class="form space-y-6">
            <div>
                <label for="totalCapacity" class="block text-sm font-medium text-gray-700 text-right mb-2">ظرفیت کل
                    اقامتگاه (تعداد نفر)</label>
                <input type="number" id="totalCapacity" name="totalCapacity" min="1" required value="50"
                       class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-right">
            </div>
            <div>
                <label for="maxStayHours" class="block text-sm font-medium text-gray-700 text-right mb-2">مدت مجاز حضور
                    هر فرد (ساعت)</label>
                <input type="number" id="maxStayHours" name="maxStayHours" min="1" required value="24"
                       class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-right">
            </div>
            <div>
                <label for="backgroundImageSelect" class="block text-sm font-medium text-gray-700 text-right mb-2">انتخاب
                    تصویر پس‌زمینه</label>
                <div class="flex gap-2 items-center">
                    <select id="backgroundImageSelect"
                            class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500 text-right">
                        <option value="Haram-1.jpg">Haram-1.jpg</option>
                        <option value="Haram-2.jpg">Haram-2.jpg</option>
                        <option value="Haram-3.jpg">Haram-3.jpg</option>
                        <option value="Graphic-1.jpg">Graphic-1.jpg</option>
                        <option value="Typo-1.jpg">Typo-1.jpg</option>
                    </select>
                    <button type="button" id="setBackgroundBtn"
                            class="flex items-center px-4 py-2 rounded-md font-medium transition-colors bg-green-600 hover:bg-green-700 text-white">
                        تایید
                    </button>
                </div>
            </div>
            <div class="flex justify-start">
                <button type="submit" onclick="setAdminSettings(event)"
                        class="flex items-center px-6 py-2 rounded-md font-medium transition-colors bg-blue-600 hover:bg-blue-700 text-white">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                         stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                         class="lucide lucide-save w-4 h-4 ml-2">
                        <path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"></path>
                        <polyline points="17 21 17 13 7 13 7 21"></polyline>
                        <polyline points="7 3 7 8 15 8"></polyline>
                    </svg>
                    ذخیره تنظیمات
                </button>
            </div>
        </form>
    </div>
</div>

<script>
    const API_URL = "{{API_URL}}";
</script>
<script src="./js/script.js"></script>
<script>
    document.addEventListener('DOMContentLoaded', function () {
        const setBackgroundBtn = document.getElementById('setBackgroundBtn');
        const bgSelect = document.getElementById('backgroundImageSelect');
        setBackgroundBtn?.addEventListener('click', function () {
            const selected = bgSelect.value;
            document.body.style.backgroundImage = `url('./images/${selected}')`;
            // Optionally, persist the selection via backend here
        });
    });
</script>
</body>

</html>